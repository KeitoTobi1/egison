listDfs(a) = matcherDFS
             | <nil> as () ->
               | [] -> {()}
               | _ -> {}
             | <cons $ $> as (a, listDfs(a)) ->
               | [$x, @$xs] -> {(x, xs)}
               | _ -> {}
             | <snoc $ $> as (a, listDfs(a)) ->
               | [@$xs, $x] -> {(x, xs)}
               | _ -> {}
             | <join $ $> as (listDfs(a), listDfs(a)) ->
               | $tgt -> matchAll tgt as listDfs(a)
                         | loop($i, [1, $n], <cons $xa_i ...>, $rs) ->
                             (foldr((%i, %r -> [xa_i, @r]), [], 1..n), rs)
             | <nioj $ $> as (listDfs(a), listDfs(a)) ->
               | $tgt -> matchAll tgt as listDfs(a)
                         | loop($i, [1, $n], <snoc $xa_i ...>, $rs) ->
                             (foldr((%i, %r -> [@r, xa_i]), [], 1..n), rs)
             | ,$val as () ->
               | $tgt -> if val == tgt then {()} else {}
             | $ as (something) ->
               | $tgt -> {tgt}

matchAll (1..5) as listDfs(integer)
| _ <++> $x <:> _ <++> $y <:> _ -> [x, y]
