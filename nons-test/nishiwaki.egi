nishiwakiIf =
  macro((b, e1, e2),
    car(matchAll b as matcher([$, something, [#t -> {e1}, #f -> {e2}]])
        | $x -> x))

nishiwakiIf(#t, 1, 2) ; 1

nishiwakiIf(#f, 1, 2) ; 2

nishiwakiIf(eq?(1, 1), 1, 2) ; 1

io(nishiwakiIf(#t, print("OK"), print("NG"))) ; print "OK"

io(nishiwakiIf(#f, print("NG"), print("OK"))) ; print "OK"

io(nishiwakiIf(eq?(1, 1), print("OK"), print("NG"))) ; print "OK"
